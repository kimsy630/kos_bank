<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace = "spring.mvc.teamProject.persistence.FinancialProductsDAO">
	
	<select id="selectById" resultType="spring.mvc.teamProject.vo.AccountVO" >
		 select *
		 from account_info
         where id = #{id} AND accountType = '입출금' AND accountState = '정상'
	</select>
	
	<select id="checkPwd" resultType="int">
		select COUNT(*) 
		from account_info
		where account = #{account} AND accountPW = #{accountPW}
	</select>
	
	<select id="checkBalance" resultType="int">
		<![CDATA[
		select COUNT(*)
		from account_info
		where account = #{account} AND Balance >= #{balance}
		]]> 
	</select>
	
	<select id="getDepositAccount" resultType="String">
		SELECT '33'||'-'||'03'||'-'||LPAD(SEQ_ACCOUNT.NEXTVAL,6,0)
		FROM DUAL
	</select>
	
	<select id="getSavingsAccount" resultType="String">
		SELECT '33'||'-'||'02'||'-'||LPAD(SEQ_ACCOUNT.NEXTVAL,6,0)
		FROM DUAL
	</select>
	
	<select id="getSavingsList" resultType="spring.mvc.teamProject.vo.savings_productVO">
		select * from savings_product
	</select>
	
	<select id="getDepositList" resultType="spring.mvc.teamProject.vo.DepositVO">
		select * from deposit_product
	</select>
	
	<select id="getSavingsDetail" resultType="spring.mvc.teamProject.vo.savings_productVO">
		select * 
		from savings_product
		where j_name = #{j_name}
	</select>
	
	<select id="getDepositDetail" resultType="spring.mvc.teamProject.vo.DepositVO">
		select * 
		from deposit_product
		where y_name = #{y_name}
	</select>
	
	<insert id="insertDepositAccount" parameterType="spring.mvc.teamProject.vo.AccountVO">
		INSERT INTO account_info(account,ID,accountPW,accountType,accountState)
		VALUES(#{account},#{id},#{accountPW},'예금','대기')
	</insert>
	
	<insert id="insertDeposit" parameterType="spring.mvc.teamProject.vo.FixedVO">
		INSERT INTO fixed_deposit(y_Key, y_name, account, y_rate, y_type, y_balance, y_end_date)
		VALUES(SEQ_DEPOSIT.NEXTVAL, #{y_name}, #{account}, #{y_rate}, #{y_type}, #{y_balance}, #{y_end_date})
	</insert>
	
	<insert id="insertSavingsAccount" parameterType="spring.mvc.teamProject.vo.AccountVO">
		INSERT INTO account_info(account,ID,accountPW,accountType,accountState)
		VALUES(#{account},#{id},#{accountPW},'적금','대기')
	</insert>
	
	<insert id="insertFreeSavings" parameterType="spring.mvc.teamProject.vo.installment_savingsVO">
		INSERT INTO installment_savings(j_Key, j_name, account, j_rate, j_type, j_method, j_end_date)
		VALUES(SEQ_SAVINGS.NEXTVAL, #{j_name}, #{account}, #{j_rate}, #{j_type}, #{j_method}, #{j_end_date})
	</insert>
	
	<insert id="insertFixedSavings" parameterType="spring.mvc.teamProject.vo.installment_savingsVO">
		INSERT INTO installment_savings(j_Key, j_name, account, j_rate, j_money, j_type, j_method, j_end_date, j_auto_date)
		VALUES(SEQ_SAVINGS.NEXTVAL, #{j_name}, #{account}, #{j_rate}, #{j_money}, #{j_type}, #{j_method}, #{j_end_date}, #{j_auto_date})
	</insert>
		
</mapper>